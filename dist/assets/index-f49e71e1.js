var te=Object.defineProperty;var ne=(n,e,t)=>e in n?te(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var f=(n,e,t)=>(ne(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function t(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(o){if(o.ep)return;o.ep=!0;const a=t(o);fetch(o.href,a)}})();let d;const Y=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&Y.decode();let D=null;function A(){return(D===null||D.byteLength===0)&&(D=new Uint8Array(d.memory.buffer)),D}function w(n,e){return n=n>>>0,Y.decode(A().subarray(n,n+e))}const T=new Array(128).fill(void 0);T.push(void 0,null,!0,!1);let M=T.length;function c(n){M===T.length&&T.push(T.length+1);const e=M;return M=T[e],T[e]=n,e}function i(n){return T[n]}function re(n){n<132||(T[n]=M,M=n)}function B(n){const e=i(n);return re(n),e}let C=0;const O=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},ie=typeof O.encodeInto=="function"?function(n,e){return O.encodeInto(n,e)}:function(n,e){const t=O.encode(n);return e.set(t),{read:n.length,written:t.length}};function I(n,e,t){if(t===void 0){const u=O.encode(n),g=e(u.length,1)>>>0;return A().subarray(g,g+u.length).set(u),C=u.length,g}let r=n.length,o=e(r,1)>>>0;const a=A();let s=0;for(;s<r;s++){const u=n.charCodeAt(s);if(u>127)break;a[o+s]=u}if(s!==r){s!==0&&(n=n.slice(s)),o=t(o,r,r=s+n.length*3,1)>>>0;const u=A().subarray(o+s,o+r),g=ie(n,u);s+=g.written}return C=s,o}function y(n){return n==null}let N=null;function p(){return(N===null||N.byteLength===0)&&(N=new Int32Array(d.memory.buffer)),N}let k=null;function oe(){return(k===null||k.byteLength===0)&&(k=new Float64Array(d.memory.buffer)),k}function V(n){const e=typeof n;if(e=="number"||e=="boolean"||n==null)return`${n}`;if(e=="string")return`"${n}"`;if(e=="symbol"){const o=n.description;return o==null?"Symbol":`Symbol(${o})`}if(e=="function"){const o=n.name;return typeof o=="string"&&o.length>0?`Function(${o})`:"Function"}if(Array.isArray(n)){const o=n.length;let a="[";o>0&&(a+=V(n[0]));for(let s=1;s<o;s++)a+=", "+V(n[s]);return a+="]",a}const t=/\[object ([^\]]+)\]/.exec(toString.call(n));let r;if(t.length>1)r=t[1];else return toString.call(n);if(r=="Object")try{return"Object("+JSON.stringify(n)+")"}catch{return"Object"}return n instanceof Error?`${n.name}: ${n.message}
${n.stack}`:r}function m(n,e,t,r){const o={a:n,b:e,cnt:1,dtor:t},a=(...s)=>{o.cnt++;const u=o.a;o.a=0;try{return r(u,o.b,...s)}finally{--o.cnt===0?d.__wbindgen_export_2.get(o.dtor)(u,o.b):o.a=u}};return a.original=o,a}function v(n,e,t){d._dyn_core__ops__function__FnMut__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__h1858851c5f543baf(n,e,c(t))}function ae(n,e){d._dyn_core__ops__function__FnMut_____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__h5ecaf6b9b2d4c6a3(n,e)}function G(n,e,t){d._dyn_core__ops__function__FnMut__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__h9efc8ea780d7daad(n,e,c(t))}function ce(n,e,t){d._dyn_core__ops__function__FnMut__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__ha61c67282e0d3fc1(n,e,c(t))}function se(n,e,t){d._dyn_core__ops__function__FnMut__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__hfb49517e7a226889(n,e,c(t))}function E(n,e,t,r){d.run(n,e,t,r)}function b(n,e){try{return n.apply(this,e)}catch(t){d.__wbindgen_exn_store(c(t))}}let P=null;function ue(){return(P===null||P.byteLength===0)&&(P=new Uint32Array(d.memory.buffer)),P}function F(n,e){return n=n>>>0,ue().subarray(n/4,n/4+e)}function le(n,e,t,r){d.wasm_bindgen__convert__closures__invoke2_mut__h997f02c5b7d8b052(n,e,c(t),c(r))}const h=Object.freeze({Curl:0,0:"Curl",Ux:1,1:"Ux",Uy:2,2:"Uy",Rho:3,3:"Rho",Speed:4,4:"Speed"}),j=Object.freeze({Inferno:0,0:"Inferno",Viridis:1,1:"Viridis",Jet:2,2:"Jet"}),X=Object.freeze({Line:0,0:"Line",Erase:1,1:"Erase",Draw:2,2:"Draw",Inactive:3,3:"Inactive"}),L=Object.freeze({Equilibrium:0,0:"Equilibrium",CustomSpeed:1,1:"CustomSpeed",SingleNorth:2,2:"SingleNorth",SingleOrigin:3,3:"SingleOrigin",SingleEast:4,4:"SingleEast",SingleNorthEast:5,5:"SingleNorthEast"}),R=Object.freeze({Welcome:0,0:"Welcome",Tunnel:1,1:"Tunnel",Curl:2,2:"Curl",Chaos:3,3:"Chaos"}),_=Object.freeze({TEST:1e3,1e3:"TEST",NHD:230400,230400:"NHD",HD:921600,921600:"HD",FHD:2073600,2073600:"FHD",UHD:3686400,3686400:"UHD"});class l{__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){const e=this.__destroy_into_raw();d.__wbg_wasminteraction_free(e)}static set_output(e){d.wasminteraction_set_output(e)}static set_draw_type(e){d.wasminteraction_set_draw_type(e)}static set_color_map(e){d.wasminteraction_set_color_map(e)}static toggle_pause(){d.wasminteraction_toggle_pause()}static update_compute_rate(e){d.wasminteraction_update_compute_rate(e)}static update_viscosity(e){d.wasminteraction_update_viscosity(e)}static update_flow_speed(e){d.wasminteraction_update_flow_speed(e)}static undo(){d.wasminteraction_undo()}static set_step_mode(){d.wasminteraction_set_step_mode()}static release_step_mode(){d.wasminteraction_release_step_mode()}static take_step(){d.wasminteraction_take_step()}static change_fluid_preset(e){d.wasminteraction_change_fluid_preset(e)}static change_barrier_preset(e){d.wasminteraction_change_barrier_preset(e)}}async function de(n,e){if(typeof Response=="function"&&n instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(n,e)}catch(r){if(n.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const t=await n.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{const t=await WebAssembly.instantiate(n,e);return t instanceof WebAssembly.Instance?{instance:t,module:n}:t}}function _e(){const n={};return n.wbg={},n.wbg.__wbindgen_string_new=function(e,t){const r=w(e,t);return c(r)},n.wbg.__wbindgen_object_drop_ref=function(e){B(e)},n.wbg.__wbindgen_cb_drop=function(e){const t=B(e).original;return t.cnt--==1?(t.a=0,!0):!1},n.wbg.__wbindgen_object_clone_ref=function(e){const t=i(e);return c(t)},n.wbg.__wbindgen_string_get=function(e,t){const r=i(t),o=typeof r=="string"?r:void 0;var a=y(o)?0:I(o,d.__wbindgen_malloc,d.__wbindgen_realloc),s=C;p()[e/4+1]=s,p()[e/4+0]=a},n.wbg.__wbindgen_is_object=function(e){const t=i(e);return typeof t=="object"&&t!==null},n.wbg.__wbg_Window_3cfcdcb1aa106442=function(e){const t=i(e).Window;return c(t)},n.wbg.__wbindgen_is_undefined=function(e){return i(e)===void 0},n.wbg.__wbg_WorkerGlobalScope_446a93e502b1149a=function(e){const t=i(e).WorkerGlobalScope;return c(t)},n.wbg.__wbindgen_number_get=function(e,t){const r=i(t),o=typeof r=="number"?r:void 0;oe()[e/8+1]=y(o)?0:o,p()[e/4+0]=!y(o)},n.wbg.__wbg_instanceof_Window_9029196b662bc42a=function(e){let t;try{t=i(e)instanceof Window}catch{t=!1}return t},n.wbg.__wbg_document_f7ace2b956f30a4f=function(e){const t=i(e).document;return y(t)?0:c(t)},n.wbg.__wbg_navigator_7c9103698acde322=function(e){const t=i(e).navigator;return c(t)},n.wbg.__wbg_innerWidth_ebe07ce5463ff293=function(){return b(function(e){const t=i(e).innerWidth;return c(t)},arguments)},n.wbg.__wbg_innerHeight_2dd06d8cf68f1d7d=function(){return b(function(e){const t=i(e).innerHeight;return c(t)},arguments)},n.wbg.__wbg_devicePixelRatio_f9de7bddca0eaf20=function(e){return i(e).devicePixelRatio},n.wbg.__wbg_matchMedia_12ef69056e32d0b3=function(){return b(function(e,t,r){const o=i(e).matchMedia(w(t,r));return y(o)?0:c(o)},arguments)},n.wbg.__wbg_get_cb7c1c2da725c920=function(e,t,r){const o=i(e)[w(t,r)];return y(o)?0:c(o)},n.wbg.__wbg_cancelAnimationFrame_9b68e9588c6543bc=function(){return b(function(e,t){i(e).cancelAnimationFrame(t)},arguments)},n.wbg.__wbg_requestAnimationFrame_d082200514b6674d=function(){return b(function(e,t){return i(e).requestAnimationFrame(i(t))},arguments)},n.wbg.__wbg_clearTimeout_220be2fa0577b342=function(e,t){i(e).clearTimeout(t)},n.wbg.__wbg_setTimeout_eb1a0d116c26d9f6=function(){return b(function(e,t,r){return i(e).setTimeout(i(t),r)},arguments)},n.wbg.__wbg_body_674aec4c1c0910cd=function(e){const t=i(e).body;return y(t)?0:c(t)},n.wbg.__wbg_fullscreenElement_07d5b77ef6c958c1=function(e){const t=i(e).fullscreenElement;return y(t)?0:c(t)},n.wbg.__wbg_createElement_4891554b28d3388b=function(){return b(function(e,t,r){const o=i(e).createElement(w(t,r));return c(o)},arguments)},n.wbg.__wbg_querySelectorAll_c03e8664a5a0f0c5=function(){return b(function(e,t,r){const o=i(e).querySelectorAll(w(t,r));return c(o)},arguments)},n.wbg.__wbindgen_number_new=function(e){return c(e)},n.wbg.__wbg_x_6c8af74c3b4d8c09=function(e){return i(e).x},n.wbg.__wbg_y_4cca2672ce1b5fc1=function(e){return i(e).y},n.wbg.__wbg_requestAdapter_d8298d7a27a391f0=function(e,t){const r=i(e).requestAdapter(i(t));return c(r)},n.wbg.__wbg_features_dfb2178c91fa1dd7=function(e){const t=i(e).features;return c(t)},n.wbg.__wbg_queue_f2aeb5c277e56f93=function(e){const t=i(e).queue;return c(t)},n.wbg.__wbg_setonuncapturederror_b3c814f611d5e585=function(e,t){i(e).onuncapturederror=i(t)},n.wbg.__wbg_createBindGroup_fa5515d52f9c6a69=function(e,t){const r=i(e).createBindGroup(i(t));return c(r)},n.wbg.__wbg_createBindGroupLayout_af3b9d9ee0a1f5f9=function(e,t){const r=i(e).createBindGroupLayout(i(t));return c(r)},n.wbg.__wbg_createBuffer_36e159f52cc644a7=function(e,t){const r=i(e).createBuffer(i(t));return c(r)},n.wbg.__wbg_createCommandEncoder_a50a1dab2b499b95=function(e,t){const r=i(e).createCommandEncoder(i(t));return c(r)},n.wbg.__wbg_createComputePipeline_89131452dfd12672=function(e,t){const r=i(e).createComputePipeline(i(t));return c(r)},n.wbg.__wbg_createPipelineLayout_1e10c8281fb85c01=function(e,t){const r=i(e).createPipelineLayout(i(t));return c(r)},n.wbg.__wbg_createQuerySet_ccb746122176f8e5=function(e,t){const r=i(e).createQuerySet(i(t));return c(r)},n.wbg.__wbg_createRenderBundleEncoder_ad2d0237f581427b=function(e,t){const r=i(e).createRenderBundleEncoder(i(t));return c(r)},n.wbg.__wbg_createRenderPipeline_745f00bcb1ca6edf=function(e,t){const r=i(e).createRenderPipeline(i(t));return c(r)},n.wbg.__wbg_createSampler_09cd36835c9befb3=function(e,t){const r=i(e).createSampler(i(t));return c(r)},n.wbg.__wbg_createShaderModule_59bbf537b8b5cf7c=function(e,t){const r=i(e).createShaderModule(i(t));return c(r)},n.wbg.__wbg_createTexture_dbd00b550944125c=function(e,t){const r=i(e).createTexture(i(t));return c(r)},n.wbg.__wbg_popErrorScope_19075fb98a08b740=function(e){const t=i(e).popErrorScope();return c(t)},n.wbg.__wbg_pushErrorScope_0728aae3f2d3ed48=function(e,t){i(e).pushErrorScope(B(t))},n.wbg.__wbg_get_c77649dd3862b63a=function(e,t){const r=i(e)[t>>>0];return y(r)?0:c(r)},n.wbg.__wbg_setwidth_15266a5e81f43cf0=function(e,t){i(e).width=t>>>0},n.wbg.__wbg_setheight_2e9bab573f1775a6=function(e,t){i(e).height=t>>>0},n.wbg.__wbg_now_0cfdc90c97d0c24b=function(e){return i(e).now()},n.wbg.__wbg_pointerId_701aab7b4fb073ff=function(e){return i(e).pointerId},n.wbg.__wbg_pressure_e388b6fd623a3917=function(e){return i(e).pressure},n.wbg.__wbg_pointerType_0009b1e4e6b0f428=function(e,t){const r=i(t).pointerType,o=I(r,d.__wbindgen_malloc,d.__wbindgen_realloc),a=C;p()[e/4+1]=a,p()[e/4+0]=o},n.wbg.__wbg_deltaX_84508d00a1050e70=function(e){return i(e).deltaX},n.wbg.__wbg_deltaY_64823169afb0335d=function(e){return i(e).deltaY},n.wbg.__wbg_deltaMode_1c680147cfdba8a5=function(e){return i(e).deltaMode},n.wbg.__wbg_createView_3e46af1f54fdcd1f=function(e,t){const r=i(e).createView(i(t));return c(r)},n.wbg.__wbg_destroy_728f676d96e34538=function(e){i(e).destroy()},n.wbg.__wbg_matches_0f7e350783b542c2=function(e){return i(e).matches},n.wbg.__wbg_maxTextureDimension1D_4d1ddb46ed9dc470=function(e){return i(e).maxTextureDimension1D},n.wbg.__wbg_maxTextureDimension2D_37a46e61490c8297=function(e){return i(e).maxTextureDimension2D},n.wbg.__wbg_maxTextureDimension3D_7e3a97204d211743=function(e){return i(e).maxTextureDimension3D},n.wbg.__wbg_maxTextureArrayLayers_fee4db585706a5eb=function(e){return i(e).maxTextureArrayLayers},n.wbg.__wbg_maxBindGroups_dc8a5f97ba653c91=function(e){return i(e).maxBindGroups},n.wbg.__wbg_maxBindingsPerBindGroup_3d5ab311420be5df=function(e){return i(e).maxBindingsPerBindGroup},n.wbg.__wbg_maxDynamicUniformBuffersPerPipelineLayout_6b839b7dc97f34f0=function(e){return i(e).maxDynamicUniformBuffersPerPipelineLayout},n.wbg.__wbg_maxDynamicStorageBuffersPerPipelineLayout_5328cd2b9d884831=function(e){return i(e).maxDynamicStorageBuffersPerPipelineLayout},n.wbg.__wbg_maxSampledTexturesPerShaderStage_ac006b00cf776b4a=function(e){return i(e).maxSampledTexturesPerShaderStage},n.wbg.__wbg_maxSamplersPerShaderStage_dc092d6a272be20a=function(e){return i(e).maxSamplersPerShaderStage},n.wbg.__wbg_maxStorageBuffersPerShaderStage_dc5b58734b9ab932=function(e){return i(e).maxStorageBuffersPerShaderStage},n.wbg.__wbg_maxStorageTexturesPerShaderStage_2fec939cb0d5bbfd=function(e){return i(e).maxStorageTexturesPerShaderStage},n.wbg.__wbg_maxUniformBuffersPerShaderStage_b30d53cbf89caeae=function(e){return i(e).maxUniformBuffersPerShaderStage},n.wbg.__wbg_maxUniformBufferBindingSize_eec576e1342504b5=function(e){return i(e).maxUniformBufferBindingSize},n.wbg.__wbg_maxStorageBufferBindingSize_1ef0cc5e43dad09b=function(e){return i(e).maxStorageBufferBindingSize},n.wbg.__wbg_maxVertexBuffers_b4d31be9e3f93990=function(e){return i(e).maxVertexBuffers},n.wbg.__wbg_maxVertexAttributes_904c5eb19a6f6c65=function(e){return i(e).maxVertexAttributes},n.wbg.__wbg_maxVertexBufferArrayStride_6800975c373d83bc=function(e){return i(e).maxVertexBufferArrayStride},n.wbg.__wbg_width_2931aaedd21f1fff=function(e){return i(e).width},n.wbg.__wbg_setwidth_a667a942dba6656e=function(e,t){i(e).width=t>>>0},n.wbg.__wbg_height_0d36fbbeb60b0661=function(e){return i(e).height},n.wbg.__wbg_setheight_a747d440760fe5aa=function(e,t){i(e).height=t>>>0},n.wbg.__wbg_getContext_7c5944ea807bf5d3=function(){return b(function(e,t,r){const o=i(e).getContext(w(t,r));return y(o)?0:c(o)},arguments)},n.wbg.__wbg_clientX_1a480606ab0cabaa=function(e){return i(e).clientX},n.wbg.__wbg_clientY_9c7878f7faf3900f=function(e){return i(e).clientY},n.wbg.__wbg_offsetX_5a58f16f6c3a41b6=function(e){return i(e).offsetX},n.wbg.__wbg_offsetY_c45b4956f6429a95=function(e){return i(e).offsetY},n.wbg.__wbg_ctrlKey_0a805df688b5bf42=function(e){return i(e).ctrlKey},n.wbg.__wbg_shiftKey_8a070ab6169b5fa4=function(e){return i(e).shiftKey},n.wbg.__wbg_altKey_6fc1761a6b7a406e=function(e){return i(e).altKey},n.wbg.__wbg_metaKey_d89287be4389a3c1=function(e){return i(e).metaKey},n.wbg.__wbg_button_7a095234b69de930=function(e){return i(e).button},n.wbg.__wbg_buttons_d0f40e1650e3fa28=function(e){return i(e).buttons},n.wbg.__wbg_movementX_966ec323c169d1a6=function(e){return i(e).movementX},n.wbg.__wbg_movementY_b14b3bc8e1b31f23=function(e){return i(e).movementY},n.wbg.__wbg_getBindGroupLayout_20dc45d52b96fa42=function(e,t){const r=i(e).getBindGroupLayout(t>>>0);return c(r)},n.wbg.__wbg_message_c934153af8567cdb=function(e,t){const r=i(t).message,o=I(r,d.__wbindgen_malloc,d.__wbindgen_realloc),a=C;p()[e/4+1]=a,p()[e/4+0]=o},n.wbg.__wbg_copyExternalImageToTexture_819ec294d299f624=function(e,t,r,o){i(e).copyExternalImageToTexture(i(t),i(r),i(o))},n.wbg.__wbg_submit_3104e9b014f75846=function(e,t){i(e).submit(i(t))},n.wbg.__wbg_writeBuffer_becf0c8f0323ffd7=function(e,t,r,o,a,s){i(e).writeBuffer(i(t),r,i(o),a,s)},n.wbg.__wbg_writeTexture_465ecc6146e5052c=function(e,t,r,o,a){i(e).writeTexture(i(t),i(r),i(o),i(a))},n.wbg.__wbg_getBindGroupLayout_dfc1b97f78c04beb=function(e,t){const r=i(e).getBindGroupLayout(t>>>0);return c(r)},n.wbg.__wbg_error_f85e77a2651e41dc=function(e){const t=i(e).error;return c(t)},n.wbg.__wbg_instanceof_GpuCanvasContext_7a77e275c38d41d8=function(e){let t;try{t=i(e)instanceof GPUCanvasContext}catch{t=!1}return t},n.wbg.__wbg_configure_93a57a4e5e0f8bcf=function(e,t){i(e).configure(i(t))},n.wbg.__wbg_getCurrentTexture_ecedc4f6f71990d2=function(e){const t=i(e).getCurrentTexture();return c(t)},n.wbg.__wbg_end_bdfb66792e0c59a2=function(e){i(e).end()},n.wbg.__wbg_executeBundles_0a1fdfd83c1a3e57=function(e,t){i(e).executeBundles(i(t))},n.wbg.__wbg_setBlendConstant_e89574db5137b2f6=function(e,t){i(e).setBlendConstant(i(t))},n.wbg.__wbg_setScissorRect_0af8c89e90a6e89c=function(e,t,r,o,a){i(e).setScissorRect(t>>>0,r>>>0,o>>>0,a>>>0)},n.wbg.__wbg_setStencilReference_71be0db67db2f7ab=function(e,t){i(e).setStencilReference(t>>>0)},n.wbg.__wbg_setViewport_9c5fb686baf1cf4f=function(e,t,r,o,a,s,u){i(e).setViewport(t,r,o,a,s,u)},n.wbg.__wbg_setBindGroup_ce4432036922cd83=function(e,t,r,o,a,s,u){i(e).setBindGroup(t>>>0,i(r),F(o,a),s,u>>>0)},n.wbg.__wbg_draw_6357a5fbc8a6b097=function(e,t,r,o,a){i(e).draw(t>>>0,r>>>0,o>>>0,a>>>0)},n.wbg.__wbg_drawIndexed_5d1dd89d7375148c=function(e,t,r,o,a,s){i(e).drawIndexed(t>>>0,r>>>0,o>>>0,a,s>>>0)},n.wbg.__wbg_drawIndexedIndirect_526599171cfbbee5=function(e,t,r){i(e).drawIndexedIndirect(i(t),r)},n.wbg.__wbg_drawIndirect_8dd595dc622e21ac=function(e,t,r){i(e).drawIndirect(i(t),r)},n.wbg.__wbg_setIndexBuffer_1f4a86d1cc8c16d9=function(e,t,r,o){i(e).setIndexBuffer(i(t),B(r),o)},n.wbg.__wbg_setIndexBuffer_9f8493460611f96b=function(e,t,r,o,a){i(e).setIndexBuffer(i(t),B(r),o,a)},n.wbg.__wbg_setPipeline_18ce556bdea62cc5=function(e,t){i(e).setPipeline(i(t))},n.wbg.__wbg_setVertexBuffer_2a2c84d65c1063f9=function(e,t,r,o){i(e).setVertexBuffer(t>>>0,i(r),o)},n.wbg.__wbg_setVertexBuffer_176c2dff823c42c1=function(e,t,r,o,a){i(e).setVertexBuffer(t>>>0,i(r),o,a)},n.wbg.__wbg_gpu_24536c9523d924b1=function(e){const t=i(e).gpu;return c(t)},n.wbg.__wbg_getBoundingClientRect_ac9db8cf97ca8083=function(e){const t=i(e).getBoundingClientRect();return c(t)},n.wbg.__wbg_requestFullscreen_3545278bcd44910c=function(){return b(function(e){i(e).requestFullscreen()},arguments)},n.wbg.__wbg_setAttribute_e7e80b478b7b8b2f=function(){return b(function(e,t,r,o,a){i(e).setAttribute(w(t,r),w(o,a))},arguments)},n.wbg.__wbg_setPointerCapture_e7c29336490bba19=function(){return b(function(e,t){i(e).setPointerCapture(t)},arguments)},n.wbg.__wbg_style_3801009b2339aa94=function(e){const t=i(e).style;return c(t)},n.wbg.__wbg_addEventListener_5651108fc3ffeb6e=function(){return b(function(e,t,r,o){i(e).addEventListener(w(t,r),i(o))},arguments)},n.wbg.__wbg_addEventListener_a5963e26cd7b176b=function(){return b(function(e,t,r,o,a){i(e).addEventListener(w(t,r),i(o),i(a))},arguments)},n.wbg.__wbg_removeEventListener_1fa0d9594cdb0b1d=function(){return b(function(e,t,r,o,a){i(e).removeEventListener(w(t,r),i(o),i(a))},arguments)},n.wbg.__wbg_size_6540ddb49e0d7120=function(e){return i(e).size},n.wbg.__wbg_usage_f5b34f3e0170424b=function(e){return i(e).usage},n.wbg.__wbg_destroy_9b5398e5b148e210=function(e){i(e).destroy()},n.wbg.__wbg_getMappedRange_becef7e3d9dc5489=function(e,t,r){const o=i(e).getMappedRange(t,r);return c(o)},n.wbg.__wbg_mapAsync_91acdcf41b7ae21d=function(e,t,r,o){const a=i(e).mapAsync(t>>>0,r,o);return c(a)},n.wbg.__wbg_unmap_1677c09514e08e64=function(e){i(e).unmap()},n.wbg.__wbg_finish_863657abae52896e=function(e){const t=i(e).finish();return c(t)},n.wbg.__wbg_finish_e580ef236d53f04b=function(e,t){const r=i(e).finish(i(t));return c(r)},n.wbg.__wbg_setBindGroup_6bc8944422dbb3cd=function(e,t,r,o,a,s,u){i(e).setBindGroup(t>>>0,i(r),F(o,a),s,u>>>0)},n.wbg.__wbg_draw_3958097471a10642=function(e,t,r,o,a){i(e).draw(t>>>0,r>>>0,o>>>0,a>>>0)},n.wbg.__wbg_drawIndexed_8856cc4ccffa3498=function(e,t,r,o,a,s){i(e).drawIndexed(t>>>0,r>>>0,o>>>0,a,s>>>0)},n.wbg.__wbg_drawIndexedIndirect_0404fa6cb9a6db25=function(e,t,r){i(e).drawIndexedIndirect(i(t),r)},n.wbg.__wbg_drawIndirect_95c6eb1494a44d06=function(e,t,r){i(e).drawIndirect(i(t),r)},n.wbg.__wbg_setIndexBuffer_4dc5432dc348458d=function(e,t,r,o){i(e).setIndexBuffer(i(t),B(r),o)},n.wbg.__wbg_setIndexBuffer_f3bae4da9e407eaf=function(e,t,r,o,a){i(e).setIndexBuffer(i(t),B(r),o,a)},n.wbg.__wbg_setPipeline_66f1e900256fc946=function(e,t){i(e).setPipeline(i(t))},n.wbg.__wbg_setVertexBuffer_c782d133fd439184=function(e,t,r,o){i(e).setVertexBuffer(t>>>0,i(r),o)},n.wbg.__wbg_setVertexBuffer_4da0a96267ce82db=function(e,t,r,o,a){i(e).setVertexBuffer(t>>>0,i(r),o,a)},n.wbg.__wbg_charCode_75cea1a3a6d66388=function(e){return i(e).charCode},n.wbg.__wbg_keyCode_dfa86be31f5ef90c=function(e){return i(e).keyCode},n.wbg.__wbg_altKey_612289acf855835c=function(e){return i(e).altKey},n.wbg.__wbg_ctrlKey_582686fb2263dd3c=function(e){return i(e).ctrlKey},n.wbg.__wbg_shiftKey_48e8701355d8e2d4=function(e){return i(e).shiftKey},n.wbg.__wbg_metaKey_43193b7cc99f8914=function(e){return i(e).metaKey},n.wbg.__wbg_key_8aeaa079126a9cc7=function(e,t){const r=i(t).key,o=I(r,d.__wbindgen_malloc,d.__wbindgen_realloc),a=C;p()[e/4+1]=a,p()[e/4+0]=o},n.wbg.__wbg_code_96d6322b968b2d17=function(e,t){const r=i(t).code,o=I(r,d.__wbindgen_malloc,d.__wbindgen_realloc),a=C;p()[e/4+1]=a,p()[e/4+0]=o},n.wbg.__wbg_getModifierState_5102ee8843516d2f=function(e,t,r){return i(e).getModifierState(w(t,r))},n.wbg.__wbg_setProperty_b95ef63ab852879e=function(){return b(function(e,t,r,o,a){i(e).setProperty(w(t,r),w(o,a))},arguments)},n.wbg.__wbg_target_f171e89c61e2bccf=function(e){const t=i(e).target;return y(t)?0:c(t)},n.wbg.__wbg_cancelBubble_90d1c3aa2a76cbeb=function(e){return i(e).cancelBubble},n.wbg.__wbg_preventDefault_24104f3f0a54546a=function(e){i(e).preventDefault()},n.wbg.__wbg_stopPropagation_55539cfa2506c867=function(e){i(e).stopPropagation()},n.wbg.__wbg_label_c7970304720cf8b0=function(e,t){const r=i(t).label,o=I(r,d.__wbindgen_malloc,d.__wbindgen_realloc),a=C;p()[e/4+1]=a,p()[e/4+0]=o},n.wbg.__wbg_beginComputePass_579a2563c561da68=function(e,t){const r=i(e).beginComputePass(i(t));return c(r)},n.wbg.__wbg_beginRenderPass_d04327f7231bd5af=function(e,t){const r=i(e).beginRenderPass(i(t));return c(r)},n.wbg.__wbg_clearBuffer_c370e7adb8398388=function(e,t,r){i(e).clearBuffer(i(t),r)},n.wbg.__wbg_clearBuffer_b8e6751290709d43=function(e,t,r,o){i(e).clearBuffer(i(t),r,o)},n.wbg.__wbg_copyBufferToBuffer_79ac12f409453cf0=function(e,t,r,o,a,s){i(e).copyBufferToBuffer(i(t),r,i(o),a,s)},n.wbg.__wbg_copyBufferToTexture_ac956e6d47c24e73=function(e,t,r,o){i(e).copyBufferToTexture(i(t),i(r),i(o))},n.wbg.__wbg_copyTextureToBuffer_787ec8d8c4c216f1=function(e,t,r,o){i(e).copyTextureToBuffer(i(t),i(r),i(o))},n.wbg.__wbg_copyTextureToTexture_a86e849469b0ef38=function(e,t,r,o){i(e).copyTextureToTexture(i(t),i(r),i(o))},n.wbg.__wbg_finish_5153789564a5eee5=function(e){const t=i(e).finish();return c(t)},n.wbg.__wbg_finish_d1049a13335e8326=function(e,t){const r=i(e).finish(i(t));return c(r)},n.wbg.__wbg_resolveQuerySet_8ac49c71e15cdf6a=function(e,t,r,o,a,s){i(e).resolveQuerySet(i(t),r>>>0,o>>>0,i(a),s>>>0)},n.wbg.__wbg_writeTimestamp_107647519ce52436=function(e,t,r){i(e).writeTimestamp(i(t),r>>>0)},n.wbg.__wbg_matches_07c564b5b4101cf2=function(e){return i(e).matches},n.wbg.__wbg_addListener_85fb6e4bd17e8878=function(){return b(function(e,t){i(e).addListener(i(t))},arguments)},n.wbg.__wbg_removeListener_3b62020874cfc3c7=function(){return b(function(e,t){i(e).removeListener(i(t))},arguments)},n.wbg.__wbg_dispatchWorkgroups_c484cd3530a3801d=function(e,t,r,o){i(e).dispatchWorkgroups(t>>>0,r>>>0,o>>>0)},n.wbg.__wbg_dispatchWorkgroupsIndirect_2b89ee1731fab5f8=function(e,t,r){i(e).dispatchWorkgroupsIndirect(i(t),r)},n.wbg.__wbg_end_dab719019df5969c=function(e){i(e).end()},n.wbg.__wbg_setPipeline_598117fdeb73cf8f=function(e,t){i(e).setPipeline(i(t))},n.wbg.__wbg_setBindGroup_dffce83253968cdd=function(e,t,r,o,a,s,u){i(e).setBindGroup(t>>>0,i(r),F(o,a),s,u>>>0)},n.wbg.__wbg_has_8720889cf3ad610c=function(e,t,r){return i(e).has(w(t,r))},n.wbg.__wbg_appendChild_51339d4cde00ee22=function(){return b(function(e,t){const r=i(e).appendChild(i(t));return c(r)},arguments)},n.wbg.__wbg_gpu_1678673f109c8aeb=function(e){const t=i(e).gpu;return c(t)},n.wbg.__wbg_navigator_41bd88b80ed4685e=function(e){const t=i(e).navigator;return c(t)},n.wbg.__wbg_instanceof_GpuAdapter_c0a5a310603ba618=function(e){let t;try{t=i(e)instanceof GPUAdapter}catch{t=!1}return t},n.wbg.__wbg_features_88901f43932fb28e=function(e){const t=i(e).features;return c(t)},n.wbg.__wbg_limits_a7f3fbf58768b61f=function(e){const t=i(e).limits;return c(t)},n.wbg.__wbg_requestDevice_068e794820eb88eb=function(e,t){const r=i(e).requestDevice(i(t));return c(r)},n.wbg.__wbg_instanceof_GpuOutOfMemoryError_45166ef4e2774fbe=function(e){let t;try{t=i(e)instanceof GPUOutOfMemoryError}catch{t=!1}return t},n.wbg.__wbg_instanceof_GpuValidationError_af2aa2e306669317=function(e){let t;try{t=i(e)instanceof GPUValidationError}catch{t=!1}return t},n.wbg.__wbg_debug_9a6b3243fbbebb61=function(e){console.debug(i(e))},n.wbg.__wbg_error_788ae33f81d3b84b=function(e){console.error(i(e))},n.wbg.__wbg_error_c9309504864e78b5=function(e,t){console.error(i(e),i(t))},n.wbg.__wbg_info_2e30e8204b29d91d=function(e){console.info(i(e))},n.wbg.__wbg_log_1d3ae0273d8f4f8a=function(e){console.log(i(e))},n.wbg.__wbg_warn_d60e832f9882c1b2=function(e){console.warn(i(e))},n.wbg.__wbg_new_898a68150f225f2e=function(){const e=new Array;return c(e)},n.wbg.__wbg_newnoargs_581967eacc0e2604=function(e,t){const r=new Function(w(e,t));return c(r)},n.wbg.__wbg_get_97b561fb56f034b5=function(){return b(function(e,t){const r=Reflect.get(i(e),i(t));return c(r)},arguments)},n.wbg.__wbg_call_cb65541d95d71282=function(){return b(function(e,t){const r=i(e).call(i(t));return c(r)},arguments)},n.wbg.__wbg_new_b51585de1b234aff=function(){const e=new Object;return c(e)},n.wbg.__wbg_self_1ff1d729e9aae938=function(){return b(function(){const e=self.self;return c(e)},arguments)},n.wbg.__wbg_window_5f4faef6c12b79ec=function(){return b(function(){const e=window.window;return c(e)},arguments)},n.wbg.__wbg_globalThis_1d39714405582d3c=function(){return b(function(){const e=globalThis.globalThis;return c(e)},arguments)},n.wbg.__wbg_global_651f05c6a0944d1c=function(){return b(function(){const e=global.global;return c(e)},arguments)},n.wbg.__wbg_push_ca1c26067ef907ac=function(e,t){return i(e).push(i(t))},n.wbg.__wbg_call_01734de55d61e11d=function(){return b(function(e,t,r){const o=i(e).call(i(t),i(r));return c(o)},arguments)},n.wbg.__wbg_instanceof_Object_3daa8298c86298be=function(e){let t;try{t=i(e)instanceof Object}catch{t=!1}return t},n.wbg.__wbg_is_205d914af04a8faa=function(e,t){return Object.is(i(e),i(t))},n.wbg.__wbg_valueOf_cefb0eb7807e83fb=function(e){const t=i(e).valueOf();return c(t)},n.wbg.__wbg_new_43f1b47c28813cbd=function(e,t){try{var r={a:e,b:t},o=(s,u)=>{const g=r.a;r.a=0;try{return le(g,r.b,s,u)}finally{r.a=g}};const a=new Promise(o);return c(a)}finally{r.a=r.b=0}},n.wbg.__wbg_resolve_53698b95aaf7fcf8=function(e){const t=Promise.resolve(i(e));return c(t)},n.wbg.__wbg_then_f7e06ee3c11698eb=function(e,t){const r=i(e).then(i(t));return c(r)},n.wbg.__wbg_then_b2267541e2a73865=function(e,t,r){const o=i(e).then(i(t),i(r));return c(o)},n.wbg.__wbg_buffer_085ec1f694018c4f=function(e){const t=i(e).buffer;return c(t)},n.wbg.__wbg_newwithbyteoffsetandlength_6da8e527659b86aa=function(e,t,r){const o=new Uint8Array(i(e),t>>>0,r>>>0);return c(o)},n.wbg.__wbg_new_8125e318e6245eed=function(e){const t=new Uint8Array(i(e));return c(t)},n.wbg.__wbg_set_5cf90238115182c3=function(e,t,r){i(e).set(i(t),r>>>0)},n.wbg.__wbg_length_72e2208bbc0efc61=function(e){return i(e).length},n.wbg.__wbg_buffer_f5b7059c439f330d=function(e){const t=i(e).buffer;return c(t)},n.wbg.__wbg_set_092e06b0f9d71865=function(){return b(function(e,t,r){return Reflect.set(i(e),i(t),i(r))},arguments)},n.wbg.__wbindgen_debug_string=function(e,t){const r=V(i(t)),o=I(r,d.__wbindgen_malloc,d.__wbindgen_realloc),a=C;p()[e/4+1]=a,p()[e/4+0]=o},n.wbg.__wbindgen_throw=function(e,t){throw new Error(w(e,t))},n.wbg.__wbindgen_memory=function(){const e=d.memory;return c(e)},n.wbg.__wbindgen_closure_wrapper319=function(e,t,r){const o=m(e,t,39,v);return c(o)},n.wbg.__wbindgen_closure_wrapper321=function(e,t,r){const o=m(e,t,39,v);return c(o)},n.wbg.__wbindgen_closure_wrapper323=function(e,t,r){const o=m(e,t,39,v);return c(o)},n.wbg.__wbindgen_closure_wrapper325=function(e,t,r){const o=m(e,t,39,v);return c(o)},n.wbg.__wbindgen_closure_wrapper327=function(e,t,r){const o=m(e,t,39,ae);return c(o)},n.wbg.__wbindgen_closure_wrapper329=function(e,t,r){const o=m(e,t,39,v);return c(o)},n.wbg.__wbindgen_closure_wrapper331=function(e,t,r){const o=m(e,t,39,v);return c(o)},n.wbg.__wbindgen_closure_wrapper333=function(e,t,r){const o=m(e,t,39,v);return c(o)},n.wbg.__wbindgen_closure_wrapper335=function(e,t,r){const o=m(e,t,39,v);return c(o)},n.wbg.__wbindgen_closure_wrapper867=function(e,t,r){const o=m(e,t,377,G);return c(o)},n.wbg.__wbindgen_closure_wrapper869=function(e,t,r){const o=m(e,t,377,G);return c(o)},n.wbg.__wbindgen_closure_wrapper922=function(e,t,r){const o=m(e,t,405,ce);return c(o)},n.wbg.__wbindgen_closure_wrapper1009=function(e,t,r){const o=m(e,t,431,se);return c(o)},n}function be(n,e){return d=n.exports,x.__wbindgen_wasm_module=e,k=null,N=null,P=null,D=null,d}async function x(n){if(d!==void 0)return d;typeof n>"u"&&(n="/LBM/assets/lbm_wgpu_bg.wasm");const e=_e();(typeof n=="string"||typeof Request=="function"&&n instanceof Request||typeof URL=="function"&&n instanceof URL)&&(n=fetch(n));const{instance:t,module:r}=await de(await n,e);return be(t,r)}class q{constructor(e){f(this,"runner");this.runner=e}}class fe extends q{constructor(e){super(e),x().then(()=>{this.updateWASMState(),this.initWelcomeButtons(),E(window.devicePixelRatio,_.HD,window.innerWidth,window.innerHeight)})}async fadeWelcome(){l.change_barrier_preset(R.Tunnel),await new Promise(e=>setTimeout(e,1500))}async close(){await this.fadeWelcome(),this.runner.exitWelcome()}async startTutorial(){await this.fadeWelcome(),this.runner.startTutorial()}updateWASMState(){l.set_color_map(j.Viridis),l.set_output(h.Speed),l.change_barrier_preset(R.Welcome)}initWelcomeButtons(){let e=document.createElement("div");e.className="welcome-button-container",e.appendChild(this.createButton("Tutorial",()=>this.startTutorial())),e.appendChild(this.createButton("Simulator",()=>this.close())),document.body.appendChild(e)}createButton(e,t){let r=document.createElement("button");return r.onclick=t,r.innerText=e,r.id=e.split(" ").join("-").toLowerCase(),r.className="welcome-button",r}}class Q extends q{constructor(t,r){super(r);f(this,"expanded");f(this,"state");f(this,"container");f(this,"panel");f(this,"expandButton");x().then(()=>{this.updateWASMState(t),E(window.devicePixelRatio,t.resolution,window.innerWidth,window.innerHeight)}),this.state=t,this.expanded=!1,this.container=this.initContainer(),this.panel=this.initPanel(t),this.expandButton=this.initCollapsedButtons(),this.expand(),this.handleLoaded()}handleLoaded(){!!sessionStorage.getItem("simulationLoaded")!=!0&&(alert("Resizing the browser window or changing the lattice cell count resets the simulation! Only change these if you are comfortable losing your progress."),sessionStorage.setItem("simulationLoaded","true"))}updateWASMState(t){l.set_color_map(t.color),l.set_draw_type(t.clickType),l.update_viscosity(t.viscosity),l.set_output(t.summary),l.update_compute_rate(t.computationSpeed),l.update_flow_speed(t.speed),t.stepMode?l.set_step_mode():l.release_step_mode(),t.paused&&l.toggle_pause()}initContainer(){let t=document.body.appendChild(document.createElement("div"));return t.className="container",t}initCollapsedButtons(){let t=document.createElement("div");return t.className="settings-buttons",t.appendChild(this.createSVGButton("src/assets/settings.svg","settings",()=>this.expansionButtonHandler())),t.appendChild(this.createSVGButton("src/assets/home.svg","settings",()=>this.runner.returnHome())),t}initPanel(t){let r=document.createElement("div");return r.className="panel",r.appendChild(this.createSVGButton("src/assets/close.svg","collapse",()=>this.expansionButtonHandler())),r.appendChild(this.createLabeledRow("Color Map","dropdown-row",this.initColorMapSelector(t.color))),r.appendChild(this.createLabeledRow("Draw Type","dropdown-row",this.initClickTypeSelector(t.clickType))),r.appendChild(this.createLabeledRow("Output Data","dropdown-row",this.initOutputSelector(t.summary))),r.appendChild(this.createLabeledRow("Lattice Cell Count","dropdown-row",this.initResolutionChanger(t.resolution))),r.appendChild(document.createElement("hr")),r.appendChild(this.createSliderRow("Computations Per Frame","slider-row",this.initComputeSlider(t.computationSpeed))),r.appendChild(this.createSliderRow("Viscosity","slider-row",this.initViscositySlider(t.viscosity))),r.appendChild(this.createSliderRow("Speed","slider-row",this.initSpeedSlider(t.speed))),r.appendChild(document.createElement("hr")),r.appendChild(this.setupButtons()),r}initColorMapSelector(t){let r=document.createElement("select");return Object.keys(j).filter(s=>isNaN(Number(s))).map((s,u)=>{let g=document.createElement("option");return g.value=u.toString(),g.innerHTML=s,g}).forEach(s=>r.appendChild(s)),r.selectedIndex=t,r.onchange=()=>this.setColor(parseInt(r.value)),r}setColor(t){this.state.color=t,l.set_color_map(t)}initResolutionChanger(t){function r(a,s){let u=document.createElement("option");return u.value=s.toString(),u.innerHTML=a,u}let o=document.createElement("select");switch(o.appendChild(r(_.NHD.toString(),_.NHD)),o.appendChild(r(_.HD.toString(),_.HD)),o.appendChild(r(_.FHD.toString(),_.FHD)),o.appendChild(r(_.UHD.toString(),_.UHD)),t){case _.NHD:o.selectedIndex=0;break;case _.HD:o.selectedIndex=1;break;case _.FHD:o.selectedIndex=2;break;case _.UHD:o.selectedIndex=3;break;default:o.selectedIndex=0}return o.onchange=()=>{this.state.resolution=parseInt(o.value),this.close()},o}close(){this.runner.stateChange(this.state)}initComputeSlider(t){let r=document.createElement("input");return r.type="range",r.min="1",r.max="50",r.value=t.toString(),r.step="1",r.onchange=()=>this.setComputeSpeed(parseInt(r.value)),r}setComputeSpeed(t){this.state.computationSpeed=t,l.update_compute_rate(t)}initViscositySlider(t){let r=document.createElement("input");return r.type="range",r.min="0.005",r.max="0.3",r.step="0.005",r.value=t.toString(),r.onchange=()=>this.setViscosity(parseFloat(r.value)),r}initSpeedSlider(t){let r=document.createElement("input");return r.type="range",r.min="0.0",r.max="0.3",r.step="0.005",r.value=t.toString(),r.onchange=()=>this.setSpeed(parseFloat(r.value)),r}setViscosity(t){this.state.viscosity=t,l.update_viscosity(t)}setSpeed(t){this.state.speed=t,l.update_flow_speed(t)}initOutputSelector(t){function r(a,s){let u=document.createElement("option");return u.value=s.toString(),u.innerHTML=a,u}let o=document.createElement("select");return o.appendChild(r("Curl",h.Curl)),o.appendChild(r("X Velocity",h.Ux)),o.appendChild(r("Y Velocity",h.Uy)),o.appendChild(r("Density",h.Rho)),o.appendChild(r("Speed",h.Speed)),o.selectedIndex=t,o.onchange=()=>this.setSummaryStat(parseInt(o.value)),o}setSummaryStat(t){this.state.summary=t,l.set_output(t)}createLabeledRow(t,r,o){let a=document.createElement("div");a.className=r;let s=document.createElement("span");return s.innerText=t,a.appendChild(s),a.appendChild(o),a}createSliderRow(t,r,o){let a=document.createElement("div");a.className=r;let s=document.createElement("span");s.innerText=t,s.className="slider-label",a.appendChild(s),a.appendChild(o);let u=document.createElement("span");return u.className="output",u.innerText=o.value,o.className="slider",o.oninput=()=>{u.innerText=o.value},a.appendChild(u),a}initClickTypeSelector(t){let r=document.createElement("select");return Object.keys(X).filter(s=>isNaN(Number(s))).map((s,u)=>{let g=document.createElement("option");return g.value=u.toString(),g.innerHTML=s,g}).forEach(s=>r.appendChild(s)),r.selectedIndex=t,r.onchange=()=>this.setClickType(parseInt(r.value)),r}setClickType(t){this.state.clickType=t,l.set_draw_type(t)}createButton(t,r){let o=document.createElement("button");return o.onclick=r,o.innerText=t,o.id=t.split(" ").join("-").toLowerCase(),o.className="panel-button",o}createSVGButton(t,r,o){let a=document.createElement("button");a.onclick=o,a.className="svg-button",a.id=r;let s=document.createElement("img");return s.src=t,s.alt=r,s.id=r,a.appendChild(s),a}setupButtons(){let t=document.createElement("div");return t.className="button-container",t.appendChild(this.createButton("Undo",()=>l.undo())),t.appendChild(this.createButton("Pause",()=>{l.toggle_pause(),this.state.paused=!this.state.paused,this.state.paused?document.getElementById("pause").style.color="aqua":document.getElementById("pause").style.color="white"})),t.appendChild(this.createButton("Reset Fluid",()=>l.change_fluid_preset(L.Equilibrium))),t.appendChild(this.createButton("Reset Barrier",()=>l.change_barrier_preset(R.Tunnel))),t}expansionButtonHandler(){this.expanded?this.collapse():this.expand()}expand(){this.expanded=!0,this.container.replaceChildren(this.panel)}collapse(){this.expanded=!1,this.container.replaceChildren(this.expandButton)}}class Z{constructor(e){f(this,"tutorial");this.tutorial=e}next(){this.tutorial.nextSlide()}close(){this.tutorial.close()}}class H extends Z{constructor(e,t){super(e),this.initInterface(t)}step(){l.take_step()}async loop(){for(;;)this.step(),await new Promise(e=>setTimeout(e,200))}initButtons(){let e=document.createElement("div");return e.className="tutorial-button-container",e.appendChild(this.createButton("Return Home",()=>this.close())),e.appendChild(this.createButton("Restart Simulation",()=>this.restart())),e.appendChild(this.createButton("Next",()=>this.next())),e}initInterface(e){let t=document.createElement("div");t.className="tutorial-user-interface",t.appendChild(e);let r=document.createElement("hr");t.appendChild(r),t.appendChild(this.initButtons()),document.body.appendChild(t)}createButton(e,t){let r=document.createElement("button");return r.onclick=t,r.innerText=e,r.id=e.split(" ").join("-").toLowerCase(),r.className="tutorial-button",r}}class ge extends q{constructor(t,r){super(t);f(this,"slide");f(this,"index");this.index=r,console.log("hello"),this.slide=this.createSlide(r)}close(){this.runner.returnHome()}nextSlide(){this.runner.nextSlideTutorial()}createSlide(t){switch(t){case 0:return new he(this,K());case 1:return new z(this,Pe());case 2:return new we(this,Me());case 3:return new pe(this,Re());case 4:return new me(this,Ae());case 5:return new ye(this,Oe());case 6:return new xe(this);default:return new z(this,K())}}}class z extends H{constructor(e,t){super(e,t),x().then(()=>{this.restart(),E(window.devicePixelRatio,_.TEST,window.innerWidth,window.innerHeight),this.loop()})}restart(){l.update_viscosity(1e7),l.change_fluid_preset(L.SingleNorth),l.set_output(h.Rho),l.set_step_mode()}}class we extends H{constructor(e,t){super(e,t),x().then(()=>{this.restart(),E(window.devicePixelRatio,_.TEST,window.innerWidth,window.innerHeight),this.loop()})}restart(){l.update_viscosity(.1),l.change_fluid_preset(L.SingleOrigin),l.set_output(h.Rho),l.set_step_mode()}}class pe extends H{constructor(e,t){super(e,t),x().then(()=>{this.restart(),E(window.devicePixelRatio,_.TEST,window.innerWidth,window.innerHeight),this.loop()})}restart(){l.update_viscosity(.1),l.change_fluid_preset(L.SingleEast),l.set_output(h.Rho),l.set_step_mode()}}class me extends H{constructor(e,t){super(e,t),x().then(()=>{this.restart(),E(window.devicePixelRatio,_.TEST,window.innerWidth,window.innerHeight),this.loop()})}restart(){l.update_viscosity(1e7),l.change_fluid_preset(L.SingleNorthEast),l.set_output(h.Rho),l.set_step_mode()}}class he extends H{constructor(e,t){super(e,t),x().then(()=>{this.restart(),E(window.devicePixelRatio,_.HD,window.innerWidth,window.innerHeight),this.loop()})}restart(){l.update_viscosity(.1),l.change_barrier_preset(R.Curl),l.change_fluid_preset(L.Equilibrium),l.set_output(h.Speed)}}class ye extends H{constructor(e,t){super(e,t),x().then(()=>{this.restart(),E(window.devicePixelRatio,_.FHD,window.innerWidth,window.innerHeight),this.loop()})}restart(){l.update_viscosity(.1),l.change_barrier_preset(R.Chaos),l.change_fluid_preset(L.Equilibrium),l.set_output(h.Curl)}}class xe extends Z{constructor(t){super(t);f(this,"controllerSlide");let r=sessionStorage.getItem("controls-demo")!=null?JSON.parse(sessionStorage.getItem("controls-demo")):ee;this.controllerSlide=new Se(this,r)}}class Se extends Q{constructor(t,r){super(r,t.tutorial.runner);f(this,"controllerDemo");this.controllerDemo=t,this.initTutorialPanel()}initResolutionChanger(t){function r(a,s){let u=document.createElement("option");return u.value=s.toString(),u.innerHTML=a,u}let o=document.createElement("select");switch(o.appendChild(r(_.NHD.toString(),_.NHD)),o.appendChild(r(_.HD.toString(),_.HD)),o.appendChild(r(_.FHD.toString(),_.FHD)),o.appendChild(r(_.UHD.toString(),_.UHD)),t){case _.NHD:o.selectedIndex=0;break;case _.HD:o.selectedIndex=1;break;case _.FHD:o.selectedIndex=2;break;case _.UHD:o.selectedIndex=3;break;default:o.selectedIndex=0}return o.onchange=()=>{this.state.resolution=parseInt(o.value),sessionStorage.setItem("controls-demo",JSON.stringify(this.state)),this.controllerDemo.tutorial.runner.refreshTutorial()},o}initTutorialPanel(){let t=document.createElement("div");t.className="demo-panel";let r=document.createElement("div");return r.innerText="This is what the actual simulator looks like. Expand one of the panels below if you want to know more about any of the controls.",r.className="demo-panel-intro-paragraph",t.appendChild(r),t.appendChild(ve().container),t.appendChild(document.createElement("hr")),t.appendChild(this.initButtons()),document.body.appendChild(t),t}createButton(t,r){let o=document.createElement("button");return o.onclick=r,o.innerText=t,o.id=t.split(" ").join("-").toLowerCase(),o.className="tutorial-button",o}initButtons(){let t=document.createElement("div");return t.className="tutorial-button-container",t.appendChild(this.createButton("Return Home",()=>this.controllerDemo.tutorial.close())),t.appendChild(this.createButton("Begin Simulating!",()=>this.controllerDemo.tutorial.runner.exitTutorial())),t}handleLoaded(){}}class Ce{constructor(e,t,r,o){f(this,"expanded");f(this,"innerElement");f(this,"container");f(this,"index");f(this,"accordian");this.expanded=!1,this.innerElement=t,this.container=this.initInterface(e,t),this.index=r,this.accordian=o}expand(){this.expanded=!0,this.accordian.expand(this.index),this.innerElement.style.display="block",this.container.getElementsByClassName("caret")[0].innerHTML="&#9650;"}collapse(){this.expanded=!1,this.accordian.collapse(),this.innerElement.style.display="none",this.container.getElementsByClassName("caret")[0].innerHTML="&#9660;"}clickHandler(){this.expanded?this.collapse():this.expand()}initInterface(e,t){let r=document.createElement("div");r.className="accordian-element";let o=document.createElement("button");o.onclick=()=>this.clickHandler();let a=document.createElement("span");a.className="accordian-button-text";let s=document.createElement("div");s.innerText=e,s.className="accordian-button-label";let u=document.createElement("div");return u.innerHTML="&#9660;",u.className="caret",a.appendChild(s),a.appendChild(u),o.appendChild(a),o.className="accordian-button",r.appendChild(o),r.appendChild(t),r}}class Te{constructor(){f(this,"elements");f(this,"expandedIndex");f(this,"container");this.elements=[],this.expandedIndex=null,this.container=document.createElement("div"),this.container.className="accordian-panel",document.body.appendChild(this.container)}collapse(){this.expandedIndex=null}expand(e){this.expandedIndex!=null&&this.elements[this.expandedIndex].collapse(),this.expandedIndex=e}append(e){e.collapse(),this.elements.push(e),this.container.appendChild(e.container)}}let ve=()=>{let n=new Te,e=["Color Map","Draw Type","Output data","Lattice cell count","Computations per frame","Viscosity","Speed"],t=Ee();for(let r=0;r<e.length;r++)n.append(new Ce(e[r],t[r],r,n));return n},Ee=()=>{let n=[],e=Be();e.className="inner-accordian",n.push(e);let t=Ie();t.className="inner-accordian",n.push(t);let r=Le();r.className="inner-accordian",n.push(r);let o=He();o.className="inner-accordian",n.push(o);let a=De();a.className="inner-accordian",n.push(a);let s=Ne();s.className="inner-accordian",n.push(s);let u=ke();return u.className="inner-accordian",n.push(u),n},Be=()=>{let n=`The color map selector controls the 
                output of the simulation. The descriptions below 
                describe how each map transistions. For output types 
                with negative values, the far left color represents the
                most negative value, the middle is zero, and the right is the
                most positive. For scalar values, the far left is zero, and the 
                far right is the maximum value.`,e=document.createElement("div");e.innerText=n;let t=document.createElement("ul");t.appendChild(U("Inferno: ",[new S(253,255,165),new S(189,56,85),new S(0,0,5)])),t.appendChild(U("Viridis:",[new S(254,232,38),new S(34,145,141),new S(68,2,85)])),t.appendChild(U("Jet:",[new S(0,0,122),new S(122,255,122),new S(122,0,0)]));let r=document.createElement("div");return r.appendChild(e),r.appendChild(t),r},U=(n,e)=>{let t=document.createElement("li"),r=document.createElement("span");r.innerText=n,t.appendChild(r);let o=document.createElement("div");o.className="color-container";let a=document.createElement("div");a.className="color-map-square",a.style.backgroundColor=e[0].toString(),o.appendChild(a);let s=document.createElement("span");s.innerHTML="&rarr;",s.className="right-arrow",o.appendChild(s);let u=document.createElement("div");u.className="color-map-square",u.style.backgroundColor=e[1].toString(),o.appendChild(u);let g=document.createElement("span");g.innerHTML="&rarr;",g.className="right-arrow",o.appendChild(g);let W=document.createElement("div");return W.className="color-map-square",W.style.backgroundColor=e[2].toString(),o.appendChild(W),t.className="color-row",t.appendChild(o),t};class S{constructor(e,t,r){f(this,"red");f(this,"green");f(this,"blue");this.red=e,this.green=t,this.blue=r}toString(){return console.log(`rgb(${this.red}, ${this.blue}, ${this.green})`),`rgb(${this.red},${this.green}, ${this.blue})`}}let Ie=()=>{let n=document.createElement("div"),e="The draw type selector allows you to interact with the simulation by creating fluid barriers. The following list descibes each tool.",t=document.createElement("div");t.innerText=e;let r=document.createElement("ul"),o=document.createElement("li");o.innerHTML="Draw: creates contious curves by clicking and dragging.",r.appendChild(o);let a=document.createElement("li");a.innerHTML="Erase: removes barriers by clicking and dragging.",r.appendChild(a);let s=document.createElement("li");return s.innerHTML="Line: creates straight lines between two endpoints. Click once to place the first endpoint, and click again to place the second.",r.appendChild(s),n.appendChild(t),n.appendChild(r),n},Le=()=>{let n=document.createElement("div"),e="The output data selector selects the data to plot. Each cell corresponds to one canvas pixel with a specific color representing the output.",t=document.createElement("div");t.innerText=e;let r=document.createElement("ul"),o=document.createElement("li");o.innerHTML=`Curl: a vector quantity roughly defined as the spin around a cell. 
                     Positive curl indicates clockwise spin while negative curl indicates counter-clockwise.`,r.appendChild(o);let a=document.createElement("li");a.innerHTML="X Velocity: a vector quantity representing the velocity from left to right.",r.appendChild(a);let s=document.createElement("li");s.innerHTML="Y Velocity: a vector quantity representing the velocity from bottom to top.",r.appendChild(s);let u=document.createElement("li");u.innerHTML="Density: a scalar quantity representing the total of all density vectors in a cell.",r.appendChild(u);let g=document.createElement("li");return g.innerHTML="Speed: a scalar quantity representing the fluid speed.",r.appendChild(g),n.appendChild(t),n.appendChild(r),n},He=()=>{let n="The lattice cell selector determines the number of cells in the simulation. The numbers are based on the common screen resolutions nHD, HD, FHD, and UHD.",e=document.createElement("div");return e.innerText=n,e},De=()=>{let n="This determines the number of streaming and collision steps per render. Increasing this number may make the simulation jittery.",e=document.createElement("div");return e.innerText=n,e},Ne=()=>{let n="This determines the viscosity of the fluid. In this simulator, increasing the viscosity decreases the dispersion rate in the collision step. This makes the simulation less turbulent and more stable. In the real world, honey is more viscous than water which is more viscous than acetone.",e=document.createElement("div");return e.innerText=n,e},ke=()=>{let n="This determines the speed of the fluid. Using this slider resets the fluid to the steady state flow at a given speed. Increasing the speed can lead to chaotic conditions.",e=document.createElement("div");return e.innerText=n,e},K=()=>{let n=document.createElement("div"),e=document.createElement("p");e.innerHTML='This is a two dimensional "wind" tunnel simulator written using WebAssembly and wgpu. There is a steady flow from the left side of the screen with barriers at the top and bottom. Using the drawing tools, you can make barriers to see how the fluid moves and interacts with different shapes under different fluid conditions.';let t=document.createElement("p");return t.innerHTML='Specifically, this is a D2Q9 Lattice Boltzmann method. The simulation takes place on a rectangular grid of square cells. Using a gpu, this simulation can simulate a grid with millions of cells with smooth framerates. For more scientific details about the simulation, refer to the wikipedia page <a href="https://en.wikipedia.org/wiki/Lattice_Boltzmann_methods" target="_blank">here</a>. The following pages in this tutorial will help give a better qualitative understanding of the method.',n.appendChild(e),n.appendChild(t),n},Pe=()=>{let n=document.createElement("div"),e=document.createElement("p");return e.innerHTML="As mentioned in the previous slide, this simulation takes place on a rectangular grid of square cells. Each cell tracks nine “density vectors.” Specifically, each cell tracks a northeast, north, northwest, east, west, southeast, south, southwest, and origin density (D2Q9 means the simulation takes place in two dimensions with nine vectors). The method is split into two steps, a streaming and collision step. To demonstrate the streaming step, there is one cell with a large north density on the right side of the screen. In each computation step, each density vector moves to an adjacent cell. For example, the north density moves to the cell directly above, the east density moves to a cell to the right, etc.",n.appendChild(e),n},Me=()=>{let n=document.createElement("div"),e=document.createElement("p");e.innerHTML='The previous slide demonstrated the streaming step. Technically, this step with particle collisions could be used as a physically accurate simulator (see <a href="https://en.wikipedia.org/wiki/Lattice_gas_automaton" target="_blank">Lattice Gas Automaton</a>). However, doing so in any meaningful way would be computationally impossible due to the astronomical number of cells needed. The lattice boltzmann method uses a collision step to make simulations more manageable. Instead of doing individual particle collisions, the lattice boltzmann method moves the current cell density distribution towards an equilibrium distribution. This allows the method to approximate more than one particle per cell.',n.appendChild(e);let t=document.createElement("p");return t.innerHTML="On the right, simulation starts with one cell with a high origin density in a non-moving fluid. Notice how the density disperses to the neighboring cells in a circular pattern. This is due to the collision step dispersing the origin density to the other density vectors. The directional density vectors then move to the adjacent cells in the streaming step.",n.appendChild(t),n},Re=()=>{let n=document.createElement("div"),e=document.createElement("p");return e.innerHTML="This slide provides an example of a cell with a directional component dispersing. On the right, you can see a simulation of a single cell with a large initial east density. As with the previous example, the density of the initial cell decreases as the density moves to adjacent cells.",n.appendChild(e),n},Ae=()=>{let n=document.createElement("div"),e=document.createElement("p");return e.innerHTML="This simulation uses no-slip boundary conditions. Simply put, all density vectors that hit boundaries reflect in the opposite direction. To the right, you can see a simulation with a single cell moving northeast. As described earlier, this cell deflects to the southwest when it hits the top boundary.",n.appendChild(e),n},Oe=()=>{let n=document.createElement("div"),e=document.createElement("p");return e.innerHTML=`Now that you have a qualitative understanding of the 
                    simulation, let’s talk about its limitations. Firstly, 
                    this simulation uses non-dimensional units, so using it 
                    for serious scientific work is futile. 
                    Although, the code could be modified to use whatever 
                    units you need, and the source code is open-source! 
                    Secondly, this simulation uses 32 bit floating point 
                    numbers. This design decision was made to match the architecture 
                    of most modern GPUs. Unfortunately, low precision floats and inherent
                    algorithmic instability can lead to chaotic results with 
                    high fluid speeds. This can be seen to the right. 
                    If you ever see this result in your own simulation, 
                    reset the fluid to restore normal conditions. 
                    High fluid speeds, low viscosities, and large
                    cell counts increase the probability of this occurring.`,n.appendChild(e),n};class We{constructor(e,t){f(this,"currentLocation");f(this,"state");this.state=e,this.currentLocation=t,sessionStorage.setItem("loaded","true"),this.createApp(t)}stateChange(e){sessionStorage.setItem("state",JSON.stringify(e)),location.reload()}exitTutorial(){let e={phase:1,tutorialIndex:0};sessionStorage.setItem("currentLocation",JSON.stringify(e)),location.reload()}refreshTutorial(){sessionStorage.setItem("currentLocation",JSON.stringify(this.currentLocation)),location.reload()}nextSlideTutorial(){this.currentLocation.tutorialIndex+=1,this.currentLocation.tutorialIndex>=Fe?this.exitTutorial():sessionStorage.setItem("currentLocation",JSON.stringify(this.currentLocation)),location.reload()}startTutorial(){let e={phase:0,tutorialIndex:0};sessionStorage.setItem("loaded","true"),sessionStorage.setItem("currentLocation",JSON.stringify(e)),location.reload()}exitWelcome(){this.exitTutorial()}returnHome(){let e={phase:2,tutorialIndex:0};sessionStorage.setItem("loaded","true"),sessionStorage.setItem("currentLocation",JSON.stringify(e)),location.reload()}createApp(e){switch(e.phase){case 2:return new fe(this);case 1:return sessionStorage.setItem("loaded","true"),new Q(this.state,this);case 0:return new ge(this,e.tutorialIndex)}}}const Fe=7,ee={resolution:_.FHD,clickType:X.Draw,summary:h.Curl,computationSpeed:15,viscosity:.1,color:j.Jet,stepMode:!1,paused:!1,speed:.1},Ue={phase:2,tutorialIndex:0};function J(){let n=sessionStorage.getItem("state")===null?ee:JSON.parse(sessionStorage.getItem("state")),e=sessionStorage.getItem("currentLocation")===null?Ue:JSON.parse(sessionStorage.getItem("currentLocation"));new We(n,e)}function $(){window.addEventListener("resize",()=>{location.reload()})}window.onload=async()=>{!!sessionStorage.getItem("loaded")==!0?(J(),$()):(await x(),await x()?(window.setTimeout(J,200),window.setTimeout($,200)):alert("Your browser is incompatible with this website. Currently, only the newest versions of edge and chrome for desktop work with web gpu"))};
